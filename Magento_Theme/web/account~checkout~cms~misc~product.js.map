{"version":3,"sources":["webpack:///./src/app/component/Form/Form.component.js","webpack:///./src/app/component/Form/Form.config.js","webpack:///./src/app/component/Form/index.js","webpack:///./src/app/util/FormPortalCollector/index.js"],"names":["Form","e","props","onSubmitSuccess","onSubmitError","onSubmit","id","preventDefault","window","formPortalCollector","collect","portalData","reduce","acc","invalidFields","inputValues","initialInvalidFields","initialInputValues","collectFieldsInformation","asyncData","Promise","all","then","asyncDataList","length","refMap","state","propsChildren","children","cloneAndValidateChildren","fieldsAreValid","setState","Object","values","input","current","value","name","checked","dataset","skipValue","type","boolValue","scrollIntoView","behavior","block","FormPortalCollector","updateChildrenRefs","mix","isInvalid","ref","form","handleFormSubmit","cloneChildren","child","createRef","cloneElement","formRef","originChildren","fieldCallback","executeClone","Children","map","FieldContainer","prototype","constructor","validateField","message","push","field","validation","inputNode","rule","find","validationConfig","validationRules","isValid","validate","defineProperty","_Form","PropTypes","func","ChildrenType","isRequired","string","MixType","MIN_PASSWORD_LENGTH","validateEmail","match","validateEmails","split","every","email","trim","validatePassword","validateTelephone","isNotEmpty","validatePasswordMatch","password","passwordValue","formConfig","__","emails","telephone","notEmpty","password_match","f","portalsObservers","portals","portal","_FormPortalCollector"],"mappings":"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","file":"account~checkout~cms~misc~product.js","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport {\n    Children,\n    cloneElement,\n    createRef,\n    PureComponent\n} from 'react';\n\nimport { FieldContainer } from 'Component/Field/Field.container';\nimport { ChildrenType, MixType } from 'Type/Common';\nimport FormPortalCollector from 'Util/FormPortalCollector';\n\nimport validationConfig from './Form.config';\n\n/** @namespace Component/Form/Component */\nexport class Form extends PureComponent {\n    static propTypes = {\n        onSubmitSuccess: PropTypes.func,\n        onSubmitError: PropTypes.func,\n        onSubmit: PropTypes.func,\n        children: ChildrenType.isRequired,\n        id: PropTypes.string,\n        mix: MixType\n    };\n\n    static defaultProps = {\n        onSubmitSuccess: () => {},\n        onSubmitError: () => {},\n        onSubmit: () => {},\n        mix: {},\n        id: ''\n    };\n\n    static updateChildrenRefs(props) {\n        const { children: propsChildren } = props;\n        const refMap = {};\n        const children = Form.cloneChildren(\n            propsChildren,\n            (child) => {\n                const { props: { name } } = child;\n                refMap[name] = createRef();\n                return cloneElement(child, { formRef: refMap[name] });\n            }\n        );\n\n        return { children, refMap };\n    }\n\n    static cloneChildren(originChildren, fieldCallback) {\n        const executeClone = (originChildren) => Children.map(originChildren, (child) => {\n            if (child && typeof child === 'object' && child.type && child.props) {\n                const { type: { name }, props, props: { children } } = child;\n\n                if (name === FieldContainer.prototype.constructor.name) {\n                    return fieldCallback(child);\n                }\n\n                if (typeof children === 'object') {\n                    return cloneElement(child, {\n                        ...props,\n                        children: executeClone(children)\n                    });\n                }\n\n                return child;\n            }\n\n            return child;\n        });\n\n        return executeClone(originChildren);\n    }\n\n    static cloneAndValidateChildren(propsChildren, refMap) {\n        const invalidFields = [];\n        const children = Form.cloneChildren(\n            propsChildren,\n            (child) => {\n                const { props: { id, name } } = child;\n                const { message } = Form.validateField(child, refMap);\n\n                if (message) {\n                    invalidFields.push(id);\n                    return cloneElement(child, { message, formRef: refMap[name] });\n                }\n\n                return cloneElement(child, { formRef: refMap[name] });\n            }\n        );\n\n        return { children, fieldsAreValid: !invalidFields.length, invalidFields };\n    }\n\n    static validateField(field, refMap) {\n        const { validation, id, name } = field.props;\n\n        if (validation && id && refMap[name] && refMap[name].current) {\n            const { current: inputNode } = refMap[name];\n\n            const rule = validation.find((rule) => {\n                if (!validationConfig[rule]) {\n                    return false;\n                }\n                const validationRules = validationConfig[rule];\n                const isValid = validationRules.validate(inputNode, refMap);\n                return !isValid;\n            });\n\n            if (rule) {\n                return validationConfig[rule];\n            }\n        }\n\n        return {};\n    }\n\n    __construct(props) {\n        super.__construct(props);\n\n        if (!window.formPortalCollector) {\n            window.formPortalCollector = new FormPortalCollector();\n        }\n\n        this.state = {\n            ...Form.updateChildrenRefs(props),\n            fieldsAreValid: true\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { refMap, fieldsAreValid } = state;\n        const { children } = props;\n        if (fieldsAreValid) {\n            return Form.updateChildrenRefs(props);\n        }\n\n        return Form.cloneAndValidateChildren(children, refMap);\n    }\n\n    handleFormSubmit = async (e) => {\n        const {\n            onSubmitSuccess,\n            onSubmitError,\n            onSubmit,\n            id\n        } = this.props;\n\n        e.preventDefault();\n        onSubmit();\n\n        const portalData = id ? await window.formPortalCollector.collect(id) : [];\n\n        const {\n            invalidFields,\n            inputValues\n        } = portalData.reduce((acc, portalData) => {\n            const {\n                invalidFields = [],\n                inputValues = {}\n            } = portalData;\n\n            const {\n                invalidFields: initialInvalidFields,\n                inputValues: initialInputValues\n            } = acc;\n\n            return ({\n                invalidFields: [...initialInvalidFields, ...invalidFields],\n                inputValues: { ...initialInputValues, ...inputValues }\n            });\n        }, this.collectFieldsInformation());\n\n        const asyncData = Promise.all(portalData.reduce((acc, { asyncData }) => {\n            if (!asyncData) {\n                return acc;\n            }\n\n            return [...acc, asyncData];\n        }, []));\n\n        asyncData.then(\n            /** @namespace Component/Form/Component/handleFormSubmitAsyncDataThen */\n            (asyncDataList) => {\n                if (!invalidFields.length) {\n                    onSubmitSuccess(inputValues, asyncDataList);\n                    return;\n                }\n\n                onSubmitError(inputValues, invalidFields);\n            },\n            /** @namespace Component/Form/Component/handleFormSubmitAsyncDataCatch */\n            (e) => onSubmitError(inputValues, invalidFields, e)\n        );\n    };\n\n    collectFieldsInformation = () => {\n        const { refMap } = this.state;\n        const { children: propsChildren } = this.props;\n\n        const {\n            children,\n            fieldsAreValid,\n            invalidFields\n        } = Form.cloneAndValidateChildren(propsChildren, refMap);\n\n        this.setState({ children, fieldsAreValid });\n\n        const inputValues = Object.values(refMap).reduce((inputValues, input) => {\n            const { current } = input;\n            if (current && current.id && current.value) {\n                const { name, value, checked } = current;\n\n                if (current.dataset.skipValue === 'true') {\n                    return inputValues;\n                }\n\n                if (current.type === 'checkbox') {\n                    const boolValue = checked;\n                    return { ...inputValues, [name]: boolValue };\n                }\n\n                return { ...inputValues, [name]: value };\n            }\n\n            return inputValues;\n        }, {});\n\n        if (invalidFields.length) {\n            const { current } = refMap[invalidFields[0]];\n\n            current.scrollIntoView({\n                behavior: 'smooth',\n                block: 'center'\n            });\n        }\n\n        return {\n            inputValues,\n            invalidFields\n        };\n    };\n\n    render() {\n        const { mix, id } = this.props;\n        const { children, fieldsAreValid } = this.state;\n\n        return (\n            <form\n              block=\"Form\"\n              mix={ mix }\n              mods={ { isInvalid: !fieldsAreValid } }\n              ref={ (ref) => {\n                  this.form = ref;\n              } }\n              id={ id }\n              onSubmit={ this.handleFormSubmit }\n            >\n                { children }\n            </form>\n        );\n    }\n}\n\nexport default Form;\n","/* eslint-disable max-len */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nexport const MIN_PASSWORD_LENGTH = 8;\n\n/** @namespace Component/Form/Config/validateEmail */\nexport const validateEmail = ({ value }) => value.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i);\n\n/** @namespace Component/Form/Config/validateEmails */\nexport const validateEmails = ({ value }) => value.split(',').every((email) => validateEmail({ value: email.trim() }));\n\n/** @namespace Component/Form/Config/validatePassword */\nexport const validatePassword = ({ value }) => value.length >= MIN_PASSWORD_LENGTH;\n\n/** @namespace Component/Form/Config/validateTelephone */\nexport const validateTelephone = ({ value }) => value.length > 0 && value.match(/^\\+(?:[0-9-] ?){6,14}[0-9]$/);\n\n/** @namespace Component/Form/Config/isNotEmpty */\nexport const isNotEmpty = ({ value }) => value.trim().length > 0;\n\n/** @namespace Component/Form/Config/validatePasswordMatch */\nexport const validatePasswordMatch = ({ value }, { password }) => {\n    const { current: { value: passwordValue } } = password || { current: {} };\n    return value === passwordValue;\n};\n\n/** @namespace Component/Form/Config */\nexport const formConfig = () => ({\n    email: {\n        validate: validateEmail,\n        message: __('Email is invalid.')\n    },\n    emails: {\n        validate: validateEmails,\n        message: __('Email addresses are not valid')\n    },\n    password: {\n        validate: validatePassword,\n        message: __('Password should be at least 8 characters long')\n    },\n    telephone: {\n        validate: validateTelephone,\n        message: __('Phone number is invalid!')\n    },\n    notEmpty: {\n        validate: isNotEmpty,\n        message: __('This field is required!')\n    },\n    password_match: {\n        validate: validatePasswordMatch,\n        message: __('Password does not match.')\n    }\n});\n\nexport default formConfig();\n","/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nexport { default } from './Form.component';\n","/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\n/** @namespace Util/FormPortalCollector */\nexport class FormPortalCollector {\n    portalsObservers = {};\n\n    subscribe(id, f, name) {\n        if (this.portalsObservers[id]) {\n            this.portalsObservers[id][name] = f;\n            return;\n        }\n\n        this.portalsObservers[id] = { [name]: f };\n    }\n\n    unsubscribe(id, name) {\n        if (!this.portalsObservers[id]) {\n            return;\n        }\n        // eslint-disable-next-line fp/no-delete\n        delete this.portalsObservers[id][name];\n    }\n\n    collect(id) {\n        const portals = this.portalsObservers[id] || {};\n        return Object.values(portals).map((portal) => portal());\n    }\n}\n\nexport default FormPortalCollector;\n"],"sourceRoot":""}